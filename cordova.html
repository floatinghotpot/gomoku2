<!DOCTYPE html>
<html>
<head>
<title>Gomoku Mist</title>
<meta charset='UTF-8'>
<meta http-equiv='Expires' CONTENT='0'>
<meta http-equiv='Cache-Control' CONTENT='no-cache'>
<meta http-equiv='Pragma' CONTENT='no-cache'>
<link rel='apple-touch-icon' href='gomoku/img/icon.png' />
<link rel='icon' type='image/png' href='gomoku/img/icon.png' />
<link href='gomoku/game.css' rel='stylesheet' type='text/css'>
<meta name='viewport'
	content='user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width' />
<script src='lib/jquery-1.9.js'></script>
<script src='lib/hotjs-mini.js'></script>
</head>
<body>
<div id='pagemain' class='page full' style='display:block;'></div>
<script type="text/javascript" src="cordova.js"></script>
<script>
window.plugins = window.plugins || {};

var ad_inited = false;
var paypalmpl_inited = false;
var iap_inited = false;

function initAd() {
	var useiAd = true;
	
	if( useiAd && window.plugins.iAd) {
		window.plugins.iAd.createBannerView({'bannerAtTop':false},function(){
	    	ad_inited = true;
	    	window.plugins.iAd.inUse = true;
	    },function(){
	    });
	} else if ( window.plugins.AdMob ) {
	    var adIdiOS = 'a151e6d43c5a28f';
	    var adIdAndroid = 'a151e6d65b12438';
	    var adId = (navigator.userAgent.indexOf('Android') >=0) ? adIdAndroid : adIdiOS;
	    
	    var am = window.plugins.AdMob;
	    am.createBannerView( 
	    		{
		            'publisherId': adId,
		            'adSize': am.AD_SIZE.BANNER,
		            'bannerAtTop': false
	            }, function() {
	            	ad_inited = true;
	            	window.plugins.AdMob.inUse = true;
	            }, function(){
	            });
	}
}

function initPayPalMPL() {
	if(! window.plugins.PayPalMPL) return;
	
    var ppm = window.plugins.PayPalMPL;
    ppm.construct( {
	      'appId': 'APP-80W284485P519543T',
	      'appEnv': ppm.PaymentEnv.ENV_SANDBOX,
	      }, function(){
			  paypalmpl_inited = true;
	      }, function(){
	      });
}

function initIAP() {
	if(! window.plugins.InAppPurchaseManager) return;
	
	var iap = window.plugins.InAppPurchaseManager;
	iap.setup();
	iap.requestProductData(
		[
			 'com.rnjsoft.GomokuMist.pkg1',
			 'com.rnjsoft.GomokuMist.pkg2',
			 'com.rnjsoft.GomokuMist.pkg3'
		 ], function( data ) {
			var validProducts = data.validProducts;
			var invalidIds = data.invalidIds;
			iap_inited = true;
		}, function() {
		});
}

document.addEventListener('deviceready', function(){
	if( window.plugins ) {
		initAd();
		initPayPalMPL();
		initIAP();
	}
	
	resources.runAppFromJs('gomoku/game.js');
}, false);

</script>
</body>
</html>
